<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mi Portfolio</title>
    <link rel="stylesheet" href="css/base/base.css" />
    <link rel="stylesheet" href="css/layout/layout.css" />
    <link rel="stylesheet" href="css/components/styles.css" />
    <link rel="stylesheet" href="css/components/header.css" />
    <link rel="stylesheet" href="css/components/footer.css" />
    <link rel="stylesheet" href="css/components/hero.css" />
    <link rel="stylesheet" href="css/components/hotspots.css" />
    <link rel="stylesheet" href="css/components/inicio.css" />
    <link rel="stylesheet" href="css/components/projects.css" />

    <!-- 1. Dependencias externas cargadas primero -->
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css"
      rel="stylesheet"
    />
    <script
      type="module"
      src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"
    ></script>

    <!-- i18next y plugins para traducción (deben ir antes de cualquier script que use i18next) -->
    <script src="https://unpkg.com/i18next@23.11.5/dist/umd/i18next.min.js"></script>
    <script src="https://unpkg.com/i18next-http-backend@2.2.0/i18nextHttpBackend.min.js"></script>
    <script src="https://unpkg.com/i18next-browser-languagedetector@7.1.0/i18nextBrowserLanguageDetector.min.js"></script>
  </head>

  <body>
    <header>
      <div id="header"></div>
    </header>
    <main>
      <div id="particles-js"></div>
      <section id="proyectos" class="projects">
        <!-- Nombre y descripción -->
        <div class="hero">
          <h1 class="underline-thick">
            <span data-i18n="hero.name">Asier</span> <br /><span class="text-outline" data-i18n="hero.surname">Martínez Corona</span>
          </h1>
          <div class="underline-rect"></div>
          <div class="content" style="margin-top: 2rem;">
            <div class="visible">
              <p data-i18n="hero.greeting">Hello</p>
              <ul>
                <li data-i18n="hero.maker">maker !</li>
                <li data-i18n="hero.portal">portal !</li>
                <li data-i18n="hero.world">world !</li>
              </ul>
            </div>
          </div>
        </div>
        


        <!-- Círculo de proyectos -->
        <div class="circle-container">
          <div class="central-item container-model">
            <!-- Objeto 3D -->
            <model-viewer
              src="assets/models/ImageToStl.com_man_bust.glb"
              alt="Modelo 3D de un mi busto"
              camera-orbit="calc(-1rad - env(window-scroll-y) * 2rad) calc(100deg - env(window-scroll-y) * 90deg) calc(0m + env(window-scroll-y) * 5m)"
              tone-mapping="neutral"
              shadow-intensity="1.09"
              exposure="0.55"
              style="width: 80%; height: 80%"
            >
              <!-- Hotspot interactivo -->
               <!-- <button class="Hotspot" slot="hotspot-1" data-position="30.41002944518105m -145.98426103479414m -195.85662280174387m" data-normal="0.12390979746671431m 0.41227628618813017m -0.902593278248116m" data-visibility-attribute="visible">
                      <div class="HotspotAnnotation">Experiencia</div>
                  </button> -->

                  

                  <!-- <button class="Hotspot" slot="hotspot-3" data-position="-148.75583275214677m -205.6815116218041m -55.00206664071516m" data-normal="0.5421952023767562m 0.31886870102357756m 0.7773976550177939m" data-visibility-attribute="visible">
                      <div class="HotspotAnnotation">Estudios</div>
                  </button>  -->

              <button class="Hotspot" slot="hotspot-2" data-position="187.16671190438376m -189.79333455305573m -22.627930157638275m" data-normal="-0.3873693771919351m 0.4630690918021439m 0.7971900537710376m" data-visibility-attribute="visible" onclick="window.location.href='ar.html?tema=fotografia'">
                <div class="HotspotAnnotation" data-i18n="hotspot.photography">Fotografía</div>
              </button>

              <button class="Hotspot" slot="hotspot-4" data-position="37.51989713458498m 168.95150710109647m -5.27067445919684m" data-normal="0.3117896730757719m 0.8321940291025504m 0.4585196808091959m" data-visibility-attribute="visible" onclick="window.location.href='ar.html?tema=interactivos'">
                <div class="HotspotAnnotation" data-i18n="hotspot.interactive">Proyectos Interactivos</div>
              </button>

              <button
                class="Hotspot"
                slot="hotspot-5"
                data-position="11.581423494609119m 174.84391373780295m -119.82441406596135m"
                data-normal="-0.4755873803284771m 0.879148375856953m -0.03024527897669384m"
                data-visibility-attribute="visible"
                onclick="window.location.href='ar.html?tema=web'"
              >
                <div class="HotspotAnnotation" data-i18n="hotspot.web">Diseño Web</div>
              </button>

              <button
                class="Hotspot"
                slot="hotspot-6"
                data-position="-62.95178101206953m 175.37618397679194m -66.42971228928386m"
                data-normal="-0.22547204232623486m 0.974088367286131m 0.01772599354271156m"
                data-visibility-attribute="visible"
                onclick="window.location.href='ar.html?tema=fabricacion'"
              >
                <div class="HotspotAnnotation" data-i18n="hotspot.fabrication">Fabricación digital</div>
              </button>

              <!-- Barra de progreso -->
              <div class="progress-bar hide" slot="progress-bar">
                <div class="update-bar"></div>
              </div>
            </model-viewer>
          </div>
        </div>
      </section>

      <!-- Selector de idioma solo para index, en la esquina inferior derecha -->
      <div id="lang-switcher-index" class="lang-switcher-hotspot">
        <button class="Hotspot lang-option" data-lang="es" title="Español">ES</button>
        <button class="Hotspot lang-option" data-lang="en" title="English">EN</button>
        <button class="Hotspot lang-option" data-lang="ca" title="Català">CA</button>
      </div>
    </main>

    <div id="threejs-bust" style="width:100vw; height:400px;"></div>

    <div id="footer" class="footer-index"></div>

    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="js/particles-init.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.177.0/build/three.min.js"></script>
    <script src="js/bust-three.js"></script>
    <script>
      particlesJS.load("particles-js", "particlesjs-config.json", function () {
        console.log("✨ Partículas cargadas correctamente");
      });
    </script>

    <script>
      // Cargar el header desde un archivo HTML externo
      fetch("components/header.html")
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("header").innerHTML = html;
        });

      // Cargar el footer desde un archivo HTML externo
      fetch("components/footer.html")
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("footer").innerHTML = html;
        });

      // Inicialización de i18next
      i18next
        .use(i18nextHttpBackend)
        .use(i18nextBrowserLanguageDetector)
        .init({
          fallbackLng: 'es',
          debug: true,
          backend: {
            loadPath: 'locales/{{lng}}/translation.json',
          },
        }, function(err, t) {
          translateAll();

          // Re-traducir header/footer tras cambio de idioma
          i18next.on('languageChanged', function() {
            // Esperar un poco para asegurar que el header/footer están en el DOM
            setTimeout(function() {
              translateAll();
            }, 100);
          });

          // Cambiar idioma al hacer click en los botones (asegurar que i18next está listo)
          document.querySelectorAll('#lang-switcher button').forEach(function(btn) {
            btn.addEventListener('click', function() {
              const lang = this.getAttribute('data-lang');
              i18next.changeLanguage(lang);
            });
          });
        });

      // Función para traducir todos los elementos con data-i18n
      function translateAll() {
        document.querySelectorAll('[data-i18n]').forEach(function(el) {
          el.innerHTML = i18next.t(el.getAttribute('data-i18n'));
        });
      }
    </script>
    <script>
      // Escucha el evento global de cambio de idioma y actualiza la página de forma reactiva
      window.addEventListener('languageChanged', function(e) {
        if (typeof window.translateAll === 'function') {
          window.translateAll();
        } else {
          location.reload();
        }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script>
      // Lógica para el selector de idioma en index (parte inferior derecha)
      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('lang-option')) {
          var lang = e.target.getAttribute('data-lang');
          if (window.i18next) {
            i18next.changeLanguage(lang, function() {
              var event = new CustomEvent('languageChanged', { detail: { lang: lang } });
              window.dispatchEvent(event);
              if (typeof window.translateAll === 'function') {
                window.translateAll();
              }
            });
          } else {
            localStorage.setItem('i18nextLng', lang);
            location.reload();
          }
        }
      });
    </script>
  </body>
</html>
